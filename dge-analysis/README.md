# ME/CFS-Differential-Gene-Expression-Analysis

This repository hosts the differential gene expression analysis of a cohort of 23 patients diagnosed with ME/CFS.

## Background

Myalgic Encephalomyelitis/Chronic Fatigue Syndrome (ME/CFS) is a chronic and debilitating illness affecting millions
of individuals worldwide. It is characterized by severe fatigue, pain, flu-like symptoms, and cognitive issues. The
cause of ME/CFS is not well understood, but evidence suggests a genetic predisposition and dysregulation of the immune
system leading to an overactive immune response.

## Installation

This project uses the `renv` package to manage R package dependencies
to ensure that the analysis can be reproduced.

### Requirements

- R ([v4.5.1](https://cran.r-project.org/bin/macosx/big-sur-x86_64/base/R-4.5.1-x86_64.pkg) or later)
- RStudio (v2025.05.1+513 or later)
- Git v2.0+

### Setup

Installation starts with fetching the Git repo and cloning it:

```bash
git clone https://github.com/uab-cgds-worthey/mecfs-cohort-analysis.git
cd mecfs-cohort-analysis/dge-analysis/
```

### Restoring the Environment

Open this directory in RStudio. Upon opening, `renv` should automatically install.

:warning: If `renv` does not install automatically, run the following command in your R console:

```r
install.packages('renv')
```

:warning: If you get the message `One or more packages recorded in the lockfile are not installed` in your R console,
then proceed with the instructions below:

```r
# Restore the R environment
renv::restore()
```

The `renv::restore()` command will install any packages that were not initially
installed.

#### Installing Workflowr

This repo depends on the `workflowr` package for managing the analysis workflow and generating reports.
If you encounter issues, follow the instructions below:

##### Windows

1. Install Rtools.
2. Restart R.
3. Then run:

```r
renv::install("git2r", type = "binary")
renv::install("workflowr")
```

##### macOS

1. Open Terminal and run: `brew install libgit2 libssh2 openssl`
2. Then in R: `renv::install("workflowr")`

##### Linux (Ubuntu/Debian)

1. In Terminal, run: `sudo apt-get install libgit2-dev libssh2-1-dev libssl-dev`

2. Then in R: `renv::install("workflowr")`

## Analysis

This project has been created using the `workflowr` template. The analysis and associated code are an extension and
modification of [Dr. Gurpreet Kaur's](https://github.com/gurpreet-bioinfo) previous work and guidance.
The Rmarkdown files for the analysis are located in the `analysis` folder.

### Input data

Our data input is generated by the [nf-core/rnaseq pipeline](https://github.com/nf-core/rnaseq) using Salmon, which
estimates gene-level counts corrected for transcript length bias.

Input file: [salmon_merged_gene_counts_length_scaled](data/star-salmon/salmon_merged_gene_counts_length_scaled.tsv)

### Rerunning the workflow

To rerun the entire workflow (and visualize the entire analysis including PCA plots, MA plots, and heatmaps), open the
project in RStudio and run the following commands in your R console:

```r
# Load the workflowr library
library(workflowr)

# Rebuild the workflow R site to view all figures in the browser
wflow_build("analysis/*.Rmd")
wflow_view()
```

## Results

Results (including figures generated for the publication) can be found in the `docs` folder or viewable at [this website](https://uab-cgds-worthey.github.io/mecfs-cohort-analysis/).

### RData File

The results, generated by
`subsetted_condition_analysis.Rmd`, are also available as an `.RData` file for
[download](https://s3.lts.rc.uab.edu/cgds-public/mecfs-cohort-analysis/publication-analysis.RData) and can be loaded
directly in R using `load("path/to/rdata")`.

## Author

Shaurita D. Hutchins [:email:](mailto:sdhutchins@uab.edu) | PhD Candidate
